06398c2683fc549d7a98ec52892c28d9
// server/persistence/db.js
const path = require('path');
const fs = require('fs');
const sqlite3 = require('sqlite3').verbose();
function ensureDir(p) {
  if (!fs.existsSync(p)) fs.mkdirSync(p, {
    recursive: true
  });
}
class DB {
  constructor(filePath) {
    this.filePath = filePath;
    this.db = null;
  }
  async init() {
    ensureDir(path.dirname(this.filePath));
    this.db = new sqlite3.Database(this.filePath);
    await this._run(`CREATE TABLE IF NOT EXISTS connections (
      id TEXT PRIMARY KEY,
      name TEXT NOT NULL,
      type TEXT NOT NULL,
      config TEXT NOT NULL,
      createdAt TEXT NOT NULL
    )`);
    await this._run(`CREATE TABLE IF NOT EXISTS users (
      id TEXT PRIMARY KEY,
      email TEXT UNIQUE NOT NULL,
      password_hash TEXT NOT NULL,
      salt TEXT NOT NULL,
      createdAt TEXT NOT NULL
    )`);
    await this._run(`CREATE TABLE IF NOT EXISTS roles (
      id TEXT PRIMARY KEY,
      name TEXT UNIQUE NOT NULL
    )`);
    await this._run(`CREATE TABLE IF NOT EXISTS user_roles (
      user_id TEXT NOT NULL,
      role_id TEXT NOT NULL,
      PRIMARY KEY (user_id, role_id)
    )`);
    await this._run(`CREATE TABLE IF NOT EXISTS user_prefs (
      user_id TEXT NOT NULL,
      key TEXT NOT NULL,
      value TEXT NOT NULL,
      PRIMARY KEY (user_id, key)
    )`);
    return this;
  }
  _run(sql, params = []) {
    return new Promise((resolve, reject) => {
      this.db.run(sql, params, function (err) {
        if (err) reject(err);else resolve(this);
      });
    });
  }
  _all(sql, params = []) {
    return new Promise((resolve, reject) => {
      this.db.all(sql, params, (err, rows) => {
        if (err) reject(err);else resolve(rows);
      });
    });
  }
  async getConnections() {
    const rows = await this._all('SELECT id, name, type, config, createdAt FROM connections ORDER BY createdAt ASC');
    return rows.map(r => ({
      id: r.id,
      name: r.name,
      type: r.type,
      config: JSON.parse(r.config),
      createdAt: r.createdAt,
      status: 'disconnected'
    }));
  }
  async upsertConnection(conn) {
    await this._run(`INSERT INTO connections (id, name, type, config, createdAt) VALUES (?, ?, ?, ?, ?)
       ON CONFLICT(id) DO UPDATE SET name=excluded.name, type=excluded.type, config=excluded.config`, [conn.id, conn.name, conn.type, JSON.stringify(conn.config || {}), conn.createdAt]);
  }
  async deleteConnection(id) {
    await this._run('DELETE FROM connections WHERE id = ?', [id]);
  }
  async replaceConnections(conns) {
    await this._run('DELETE FROM connections');
    for (const c of conns) await this.upsertConnection(c);
  }

  // Auth persistence
  async createUser({
    id,
    email,
    password_hash,
    salt,
    createdAt
  }) {
    await this._run(`INSERT INTO users (id, email, password_hash, salt, createdAt) VALUES (?, ?, ?, ?, ?)`, [id, email, password_hash, salt, createdAt]);
  }
  async getUserByEmail(email) {
    const rows = await this._all('SELECT * FROM users WHERE email = ?', [email]);
    return rows[0] || null;
  }
  async ensureRole(name) {
    const rows = await this._all('SELECT * FROM roles WHERE name = ?', [name]);
    if (rows.length) return rows[0];
    const id = `${Date.now()}-${Math.random()}`;
    await this._run('INSERT INTO roles (id, name) VALUES (?, ?)', [id, name]);
    return {
      id,
      name
    };
  }
  async assignRoleToUser(userId, roleName) {
    const role = await this.ensureRole(roleName);
    await this._run('INSERT OR IGNORE INTO user_roles (user_id, role_id) VALUES (?, ?)', [userId, role.id]);
  }
  async getRolesForUser(userId) {
    const rows = await this._all(`SELECT r.name FROM roles r JOIN user_roles ur ON r.id = ur.role_id WHERE ur.user_id = ?`, [userId]);
    return rows.map(r => r.name);
  }
  async setUserPref(userId, key, value) {
    await this._run(`INSERT INTO user_prefs (user_id, key, value) VALUES (?, ?, ?)
       ON CONFLICT(user_id, key) DO UPDATE SET value=excluded.value`, [userId, key, value]);
  }
  async getUserPref(userId, key) {
    const rows = await this._all('SELECT value FROM user_prefs WHERE user_id = ? AND key = ?', [userId, key]);
    return rows[0]?.value ?? null;
  }
}
module.exports = {
  DB
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImZzIiwic3FsaXRlMyIsInZlcmJvc2UiLCJlbnN1cmVEaXIiLCJwIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsIkRCIiwiY29uc3RydWN0b3IiLCJmaWxlUGF0aCIsImRiIiwiaW5pdCIsImRpcm5hbWUiLCJEYXRhYmFzZSIsIl9ydW4iLCJzcWwiLCJwYXJhbXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJ1biIsImVyciIsIl9hbGwiLCJhbGwiLCJyb3dzIiwiZ2V0Q29ubmVjdGlvbnMiLCJtYXAiLCJyIiwiaWQiLCJuYW1lIiwidHlwZSIsImNvbmZpZyIsIkpTT04iLCJwYXJzZSIsImNyZWF0ZWRBdCIsInN0YXR1cyIsInVwc2VydENvbm5lY3Rpb24iLCJjb25uIiwic3RyaW5naWZ5IiwiZGVsZXRlQ29ubmVjdGlvbiIsInJlcGxhY2VDb25uZWN0aW9ucyIsImNvbm5zIiwiYyIsImNyZWF0ZVVzZXIiLCJlbWFpbCIsInBhc3N3b3JkX2hhc2giLCJzYWx0IiwiZ2V0VXNlckJ5RW1haWwiLCJlbnN1cmVSb2xlIiwibGVuZ3RoIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJhc3NpZ25Sb2xlVG9Vc2VyIiwidXNlcklkIiwicm9sZU5hbWUiLCJyb2xlIiwiZ2V0Um9sZXNGb3JVc2VyIiwic2V0VXNlclByZWYiLCJrZXkiLCJ2YWx1ZSIsImdldFVzZXJQcmVmIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImRiLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNlcnZlci9wZXJzaXN0ZW5jZS9kYi5qc1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XHJcbmNvbnN0IHNxbGl0ZTMgPSByZXF1aXJlKCdzcWxpdGUzJykudmVyYm9zZSgpO1xyXG5cclxuZnVuY3Rpb24gZW5zdXJlRGlyKHApIHsgaWYgKCFmcy5leGlzdHNTeW5jKHApKSBmcy5ta2RpclN5bmMocCwgeyByZWN1cnNpdmU6IHRydWUgfSk7IH1cclxuXHJcbmNsYXNzIERCIHtcclxuICBjb25zdHJ1Y3RvcihmaWxlUGF0aCkge1xyXG4gICAgdGhpcy5maWxlUGF0aCA9IGZpbGVQYXRoO1xyXG4gICAgdGhpcy5kYiA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgZW5zdXJlRGlyKHBhdGguZGlybmFtZSh0aGlzLmZpbGVQYXRoKSk7XHJcbiAgICB0aGlzLmRiID0gbmV3IHNxbGl0ZTMuRGF0YWJhc2UodGhpcy5maWxlUGF0aCk7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGNvbm5lY3Rpb25zIChcclxuICAgICAgaWQgVEVYVCBQUklNQVJZIEtFWSxcclxuICAgICAgbmFtZSBURVhUIE5PVCBOVUxMLFxyXG4gICAgICB0eXBlIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgIGNvbmZpZyBURVhUIE5PVCBOVUxMLFxyXG4gICAgICBjcmVhdGVkQXQgVEVYVCBOT1QgTlVMTFxyXG4gICAgKWApO1xyXG4gICAgYXdhaXQgdGhpcy5fcnVuKGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB1c2VycyAoXHJcbiAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXHJcbiAgICAgIGVtYWlsIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxyXG4gICAgICBwYXNzd29yZF9oYXNoIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgIHNhbHQgVEVYVCBOT1QgTlVMTCxcclxuICAgICAgY3JlYXRlZEF0IFRFWFQgTk9UIE5VTExcclxuICAgIClgKTtcclxuICAgIGF3YWl0IHRoaXMuX3J1bihgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgcm9sZXMgKFxyXG4gICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLFxyXG4gICAgICBuYW1lIFRFWFQgVU5JUVVFIE5PVCBOVUxMXHJcbiAgICApYCk7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHVzZXJfcm9sZXMgKFxyXG4gICAgICB1c2VyX2lkIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgIHJvbGVfaWQgVEVYVCBOT1QgTlVMTCxcclxuICAgICAgUFJJTUFSWSBLRVkgKHVzZXJfaWQsIHJvbGVfaWQpXHJcbiAgICApYCk7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHVzZXJfcHJlZnMgKFxyXG4gICAgICB1c2VyX2lkIFRFWFQgTk9UIE5VTEwsXHJcbiAgICAgIGtleSBURVhUIE5PVCBOVUxMLFxyXG4gICAgICB2YWx1ZSBURVhUIE5PVCBOVUxMLFxyXG4gICAgICBQUklNQVJZIEtFWSAodXNlcl9pZCwga2V5KVxyXG4gICAgKWApO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBfcnVuKHNxbCwgcGFyYW1zID0gW10pIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMuZGIucnVuKHNxbCwgcGFyYW1zLCBmdW5jdGlvbiAoZXJyKSB7IGlmIChlcnIpIHJlamVjdChlcnIpOyBlbHNlIHJlc29sdmUodGhpcyk7IH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfYWxsKHNxbCwgcGFyYW1zID0gW10pIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMuZGIuYWxsKHNxbCwgcGFyYW1zLCAoZXJyLCByb3dzKSA9PiB7IGlmIChlcnIpIHJlamVjdChlcnIpOyBlbHNlIHJlc29sdmUocm93cyk7IH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRDb25uZWN0aW9ucygpIHtcclxuICAgIGNvbnN0IHJvd3MgPSBhd2FpdCB0aGlzLl9hbGwoJ1NFTEVDVCBpZCwgbmFtZSwgdHlwZSwgY29uZmlnLCBjcmVhdGVkQXQgRlJPTSBjb25uZWN0aW9ucyBPUkRFUiBCWSBjcmVhdGVkQXQgQVNDJyk7XHJcbiAgICByZXR1cm4gcm93cy5tYXAociA9PiAoeyBpZDogci5pZCwgbmFtZTogci5uYW1lLCB0eXBlOiByLnR5cGUsIGNvbmZpZzogSlNPTi5wYXJzZShyLmNvbmZpZyksIGNyZWF0ZWRBdDogci5jcmVhdGVkQXQsIHN0YXR1czogJ2Rpc2Nvbm5lY3RlZCcgfSkpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBzZXJ0Q29ubmVjdGlvbihjb25uKSB7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oXHJcbiAgICAgIGBJTlNFUlQgSU5UTyBjb25uZWN0aW9ucyAoaWQsIG5hbWUsIHR5cGUsIGNvbmZpZywgY3JlYXRlZEF0KSBWQUxVRVMgKD8sID8sID8sID8sID8pXHJcbiAgICAgICBPTiBDT05GTElDVChpZCkgRE8gVVBEQVRFIFNFVCBuYW1lPWV4Y2x1ZGVkLm5hbWUsIHR5cGU9ZXhjbHVkZWQudHlwZSwgY29uZmlnPWV4Y2x1ZGVkLmNvbmZpZ2AsXHJcbiAgICAgIFtjb25uLmlkLCBjb25uLm5hbWUsIGNvbm4udHlwZSwgSlNPTi5zdHJpbmdpZnkoY29ubi5jb25maWcgfHwge30pLCBjb25uLmNyZWF0ZWRBdF1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBkZWxldGVDb25uZWN0aW9uKGlkKSB7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oJ0RFTEVURSBGUk9NIGNvbm5lY3Rpb25zIFdIRVJFIGlkID0gPycsIFtpZF0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgcmVwbGFjZUNvbm5lY3Rpb25zKGNvbm5zKSB7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oJ0RFTEVURSBGUk9NIGNvbm5lY3Rpb25zJyk7XHJcbiAgICBmb3IgKGNvbnN0IGMgb2YgY29ubnMpIGF3YWl0IHRoaXMudXBzZXJ0Q29ubmVjdGlvbihjKTtcclxuICB9XHJcblxyXG4gIC8vIEF1dGggcGVyc2lzdGVuY2VcclxuICBhc3luYyBjcmVhdGVVc2VyKHsgaWQsIGVtYWlsLCBwYXNzd29yZF9oYXNoLCBzYWx0LCBjcmVhdGVkQXQgfSkge1xyXG4gICAgYXdhaXQgdGhpcy5fcnVuKFxyXG4gICAgICBgSU5TRVJUIElOVE8gdXNlcnMgKGlkLCBlbWFpbCwgcGFzc3dvcmRfaGFzaCwgc2FsdCwgY3JlYXRlZEF0KSBWQUxVRVMgKD8sID8sID8sID8sID8pYCxcclxuICAgICAgW2lkLCBlbWFpbCwgcGFzc3dvcmRfaGFzaCwgc2FsdCwgY3JlYXRlZEF0XVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFVzZXJCeUVtYWlsKGVtYWlsKSB7XHJcbiAgICBjb25zdCByb3dzID0gYXdhaXQgdGhpcy5fYWxsKCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gPycsIFtlbWFpbF0pO1xyXG4gICAgcmV0dXJuIHJvd3NbMF0gfHwgbnVsbDtcclxuICB9XHJcblxyXG4gIGFzeW5jIGVuc3VyZVJvbGUobmFtZSkge1xyXG4gICAgY29uc3Qgcm93cyA9IGF3YWl0IHRoaXMuX2FsbCgnU0VMRUNUICogRlJPTSByb2xlcyBXSEVSRSBuYW1lID0gPycsIFtuYW1lXSk7XHJcbiAgICBpZiAocm93cy5sZW5ndGgpIHJldHVybiByb3dzWzBdO1xyXG4gICAgY29uc3QgaWQgPSBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCl9YDtcclxuICAgIGF3YWl0IHRoaXMuX3J1bignSU5TRVJUIElOVE8gcm9sZXMgKGlkLCBuYW1lKSBWQUxVRVMgKD8sID8pJywgW2lkLCBuYW1lXSk7XHJcbiAgICByZXR1cm4geyBpZCwgbmFtZSB9O1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgYXNzaWduUm9sZVRvVXNlcih1c2VySWQsIHJvbGVOYW1lKSB7XHJcbiAgICBjb25zdCByb2xlID0gYXdhaXQgdGhpcy5lbnN1cmVSb2xlKHJvbGVOYW1lKTtcclxuICAgIGF3YWl0IHRoaXMuX3J1bignSU5TRVJUIE9SIElHTk9SRSBJTlRPIHVzZXJfcm9sZXMgKHVzZXJfaWQsIHJvbGVfaWQpIFZBTFVFUyAoPywgPyknLCBbdXNlcklkLCByb2xlLmlkXSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRSb2xlc0ZvclVzZXIodXNlcklkKSB7XHJcbiAgICBjb25zdCByb3dzID0gYXdhaXQgdGhpcy5fYWxsKFxyXG4gICAgICBgU0VMRUNUIHIubmFtZSBGUk9NIHJvbGVzIHIgSk9JTiB1c2VyX3JvbGVzIHVyIE9OIHIuaWQgPSB1ci5yb2xlX2lkIFdIRVJFIHVyLnVzZXJfaWQgPSA/YCxcclxuICAgICAgW3VzZXJJZF1cclxuICAgICk7XHJcbiAgICByZXR1cm4gcm93cy5tYXAociA9PiByLm5hbWUpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0VXNlclByZWYodXNlcklkLCBrZXksIHZhbHVlKSB7XHJcbiAgICBhd2FpdCB0aGlzLl9ydW4oXHJcbiAgICAgIGBJTlNFUlQgSU5UTyB1c2VyX3ByZWZzICh1c2VyX2lkLCBrZXksIHZhbHVlKSBWQUxVRVMgKD8sID8sID8pXHJcbiAgICAgICBPTiBDT05GTElDVCh1c2VyX2lkLCBrZXkpIERPIFVQREFURSBTRVQgdmFsdWU9ZXhjbHVkZWQudmFsdWVgLFxyXG4gICAgICBbdXNlcklkLCBrZXksIHZhbHVlXVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFVzZXJQcmVmKHVzZXJJZCwga2V5KSB7XHJcbiAgICBjb25zdCByb3dzID0gYXdhaXQgdGhpcy5fYWxsKCdTRUxFQ1QgdmFsdWUgRlJPTSB1c2VyX3ByZWZzIFdIRVJFIHVzZXJfaWQgPSA/IEFORCBrZXkgPSA/JywgW3VzZXJJZCwga2V5XSk7XHJcbiAgICByZXR1cm4gcm93c1swXT8udmFsdWUgPz8gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0geyBEQiB9OyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUIsTUFBTUMsRUFBRSxHQUFHRCxP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