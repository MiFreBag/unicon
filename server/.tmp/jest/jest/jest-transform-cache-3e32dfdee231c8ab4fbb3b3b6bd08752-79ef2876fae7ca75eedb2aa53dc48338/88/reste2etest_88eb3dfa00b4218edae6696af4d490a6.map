{"version":3,"names":["request","require","process","env","PORT","WS_PORT","startServers","started","beforeAll","afterAll","server","close","wsServer","test","agent","res","get","expect","status","toBe","body","toHaveProperty","Array","isArray","connections"],"sources":["rest.e2e.test.js"],"sourcesContent":["const request = require('supertest');\r\n\r\n// Set env before requiring the server module so constants pick them up\r\nprocess.env.PORT = '3101';\r\nprocess.env.WS_PORT = '8180';\r\n\r\nconst { startServers } = require('../universal-server');\r\n\r\nlet started;\r\n\r\nbeforeAll(async () => {\r\n  started = await startServers();\r\n});\r\n\r\nafterAll(() => {\r\n  if (started?.server) started.server.close();\r\n  if (started?.wsServer) started.wsServer.close();\r\n});\r\n\r\ntest('GET /unicon/api/health returns healthy', async () => {\r\n  const agent = request(`http://localhost:${process.env.PORT}`);\r\n  const res = await agent.get('/unicon/api/health');\r\n  expect(res.status).toBe(200);\r\n  expect(res.body).toHaveProperty('success', true);\r\n  expect(res.body).toHaveProperty('status', 'healthy');\r\n});\r\n\r\ntest('Connections list returns array', async () => {\r\n  const agent = request(`http://localhost:${process.env.PORT}`);\r\n  const res = await agent.get('/unicon/api/connections');\r\n  expect(res.status).toBe(200);\r\n  expect(Array.isArray(res.body.connections)).toBe(true);\r\n});"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;;AAEpC;AACAC,OAAO,CAACC,GAAG,CAACC,IAAI,GAAG,MAAM;AACzBF,OAAO,CAACC,GAAG,CAACE,OAAO,GAAG,MAAM;AAE5B,MAAM;EAAEC;AAAa,CAAC,GAAGL,OAAO,CAAC,qBAAqB,CAAC;AAEvD,IAAIM,OAAO;AAEXC,SAAS,CAAC,YAAY;EACpBD,OAAO,GAAG,MAAMD,YAAY,CAAC,CAAC;AAChC,CAAC,CAAC;AAEFG,QAAQ,CAAC,MAAM;EACb,IAAIF,OAAO,EAAEG,MAAM,EAAEH,OAAO,CAACG,MAAM,CAACC,KAAK,CAAC,CAAC;EAC3C,IAAIJ,OAAO,EAAEK,QAAQ,EAAEL,OAAO,CAACK,QAAQ,CAACD,KAAK,CAAC,CAAC;AACjD,CAAC,CAAC;AAEFE,IAAI,CAAC,wCAAwC,EAAE,YAAY;EACzD,MAAMC,KAAK,GAAGd,OAAO,CAAC,oBAAoBE,OAAO,CAACC,GAAG,CAACC,IAAI,EAAE,CAAC;EAC7D,MAAMW,GAAG,GAAG,MAAMD,KAAK,CAACE,GAAG,CAAC,oBAAoB,CAAC;EACjDC,MAAM,CAACF,GAAG,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;EAC5BF,MAAM,CAACF,GAAG,CAACK,IAAI,CAAC,CAACC,cAAc,CAAC,SAAS,EAAE,IAAI,CAAC;EAChDJ,MAAM,CAACF,GAAG,CAACK,IAAI,CAAC,CAACC,cAAc,CAAC,QAAQ,EAAE,SAAS,CAAC;AACtD,CAAC,CAAC;AAEFR,IAAI,CAAC,gCAAgC,EAAE,YAAY;EACjD,MAAMC,KAAK,GAAGd,OAAO,CAAC,oBAAoBE,OAAO,CAACC,GAAG,CAACC,IAAI,EAAE,CAAC;EAC7D,MAAMW,GAAG,GAAG,MAAMD,KAAK,CAACE,GAAG,CAAC,yBAAyB,CAAC;EACtDC,MAAM,CAACF,GAAG,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;EAC5BF,MAAM,CAACK,KAAK,CAACC,OAAO,CAACR,GAAG,CAACK,IAAI,CAACI,WAAW,CAAC,CAAC,CAACL,IAAI,CAAC,IAAI,CAAC;AACxD,CAAC,CAAC","ignoreList":[]}