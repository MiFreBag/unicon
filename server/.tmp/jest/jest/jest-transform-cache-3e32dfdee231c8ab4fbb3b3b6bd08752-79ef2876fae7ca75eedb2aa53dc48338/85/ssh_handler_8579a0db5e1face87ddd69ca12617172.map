{"version":3,"names":["Client","require","v4","uuidv4","SSHHandler","constructor","connectionId","config","client","isConnected","shells","Map","connect","Promise","resolve","reject","conn","on","_broadcast","type","data","event","success","err","Error","message","host","port","username","password","privateKey","passphrase","opts","disconnect","stream","values","end","_","clear","e","error","exec","command","cwd","stdout","stderr","code","signal","toString","shellOpen","cols","rows","sessionId","shell","term","set","delete","shellInput","entry","get","write","shellResize","setWindow","shellClose","_getSftp","sftp","sftpList","path","readdir","list","entries","map","filename","longname","attrs","sftpGet","chunks","rs","createReadStream","c","push","Buffer","from","buf","concat","base64","size","length","sftpPut","ws","createWriteStream","settled","done","setImmediate","global","broadcast","module","exports"],"sources":["ssh_handler.js"],"sourcesContent":["// server/handlers/ssh_handler.js\r\nconst { Client } = require('ssh2');\r\nconst { v4: uuidv4 } = require('uuid');\r\n\r\nclass SSHHandler {\r\n  constructor(connectionId, config) {\r\n    this.connectionId = connectionId;\r\n    this.config = config || {};\r\n    this.client = null;\r\n    this.isConnected = false;\r\n    this.shells = new Map(); // sessionId -> {stream}\r\n  }\r\n\r\n  async connect() {\r\n    return new Promise((resolve, reject) => {\r\n      const conn = new Client();\r\n      this.client = conn;\r\n\r\n      conn.on('ready', () => {\r\n        this.isConnected = true;\r\n        this._broadcast({ type: 'ssh', data: { event: 'connected', connectionId: this.connectionId } });\r\n        resolve({ success: true });\r\n      }).on('error', (err) => {\r\n        reject(new Error(`SSH error: ${err.message}`));\r\n      }).on('end', () => {\r\n        this.isConnected = false;\r\n        this._broadcast({ type: 'ssh', data: { event: 'ended', connectionId: this.connectionId } });\r\n      }).on('close', () => {\r\n        this.isConnected = false;\r\n        this._broadcast({ type: 'ssh', data: { event: 'closed', connectionId: this.connectionId } });\r\n      });\r\n\r\n      const { host, port = 22, username, password, privateKey, passphrase } = this.config;\r\n      const opts = { host, port, username };\r\n      if (password) opts.password = password;\r\n      if (privateKey) opts.privateKey = privateKey;\r\n      if (passphrase) opts.passphrase = passphrase;\r\n\r\n      conn.connect(opts);\r\n    });\r\n  }\r\n\r\n  async disconnect() {\r\n    try {\r\n      for (const { stream } of this.shells.values()) {\r\n        try { stream.end(); } catch (_) {}\r\n      }\r\n      this.shells.clear();\r\n      if (this.client) this.client.end();\r\n      this.isConnected = false;\r\n      return { success: true };\r\n    } catch (e) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  }\r\n\r\n  async exec(command, cwd) {\r\n    if (!this.isConnected || !this.client) throw new Error('SSH not connected');\r\n    return new Promise((resolve, reject) => {\r\n      this.client.exec(command, { cwd }, (err, stream) => {\r\n        if (err) return reject(err);\r\n        let stdout = '', stderr = '';\r\n        stream.on('close', (code, signal) => {\r\n          resolve({ success: true, data: { stdout, stderr, code, signal } });\r\n        }).on('data', (data) => { stdout += data.toString('utf8'); });\r\n        if (stream && stream.stderr && typeof stream.stderr.on === 'function') {\r\n          stream.stderr.on('data', (data) => { stderr += data.toString('utf8'); });\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  async shellOpen({ cols = 80, rows = 24 } = {}) {\r\n    if (!this.isConnected || !this.client) throw new Error('SSH not connected');\r\n    const sessionId = uuidv4();\r\n    return new Promise((resolve, reject) => {\r\n      this.client.shell({ cols, rows, term: 'xterm-color' }, (err, stream) => {\r\n        if (err) return reject(err);\r\n        this.shells.set(sessionId, { stream });\r\n        stream.on('data', (data) => {\r\n          this._broadcast({\r\n            type: 'ssh',\r\n            data: { event: 'shellData', sessionId, connectionId: this.connectionId, data: data.toString('utf8') }\r\n          });\r\n        });\r\n        stream.on('close', () => {\r\n          this._broadcast({ type: 'ssh', data: { event: 'shellClosed', sessionId, connectionId: this.connectionId } });\r\n          this.shells.delete(sessionId);\r\n        });\r\n        resolve({ success: true, data: { sessionId } });\r\n      });\r\n    });\r\n  }\r\n\r\n  async shellInput({ sessionId, data }) {\r\n    const entry = this.shells.get(sessionId);\r\n    if (!entry) throw new Error('Unknown shell session');\r\n    entry.stream.write(data);\r\n    return { success: true };\r\n  }\r\n\r\n  async shellResize({ sessionId, cols, rows }) {\r\n    const entry = this.shells.get(sessionId);\r\n    if (!entry) throw new Error('Unknown shell session');\r\n    try { entry.stream.setWindow(rows, cols); } catch (_) {}\r\n    return { success: true };\r\n  }\r\n\r\n  async shellClose({ sessionId }) {\r\n    const entry = this.shells.get(sessionId);\r\n    if (!entry) return { success: true };\r\n    try { entry.stream.end(); } catch (_) {}\r\n    this.shells.delete(sessionId);\r\n    return { success: true };\r\n  }\r\n\r\n  // ----- SFTP helpers -----\r\n  _getSftp() {\r\n    if (!this.client || !this.isConnected) throw new Error('SSH not connected');\r\n    return new Promise((resolve, reject) => {\r\n      this.client.sftp((err, sftp) => (err ? reject(err) : resolve(sftp)));\r\n    });\r\n  }\r\n\r\n  async sftpList({ path = '.' } = {}) {\r\n    const sftp = await this._getSftp();\r\n    return new Promise((resolve, reject) => {\r\n      sftp.readdir(path, (err, list) => {\r\n        if (err) return reject(err);\r\n        const entries = (list || []).map((e) => ({ filename: e.filename, longname: e.longname || '', attrs: e.attrs }));\r\n        resolve({ success: true, data: { entries } });\r\n      });\r\n    });\r\n  }\r\n\r\n  async sftpGet({ path }) {\r\n    if (!path) throw new Error('path required');\r\n    const sftp = await this._getSftp();\r\n    return new Promise((resolve, reject) => {\r\n      const chunks = [];\r\n      const rs = sftp.createReadStream(path);\r\n      rs.on('data', (c) => chunks.push(Buffer.from(c)));\r\n      rs.on('error', (e) => reject(e));\r\n      rs.on('end', () => {\r\n        const buf = Buffer.concat(chunks);\r\n        resolve({ success: true, data: { base64: buf.toString('base64'), size: buf.length } });\r\n      });\r\n    });\r\n  }\r\n\r\n  async sftpPut({ path, base64 }) {\r\n    if (!path) throw new Error('path required');\r\n    if (!base64) throw new Error('base64 required');\r\n    const sftp = await this._getSftp();\r\n    const buf = Buffer.from(base64, 'base64');\r\n    return new Promise((resolve, reject) => {\r\n      const ws = sftp.createWriteStream(path);\r\n      let settled = false;\r\n      const done = () => { if (!settled) { settled = true; resolve({ success: true, data: { size: buf.length } }); } };\r\n      ws.on('error', (e) => { settled = true; reject(e); });\r\n      ws.on('finish', done);\r\n      if (typeof ws.end === 'function') {\r\n        ws.end(buf);\r\n      } else if (typeof ws.write === 'function') {\r\n        try { ws.write(buf); } catch (_) {}\r\n        setImmediate(done);\r\n      } else {\r\n        setImmediate(done);\r\n      }\r\n    });\r\n  }\r\n\r\n  _broadcast(message) {\r\n    if (global.broadcast) global.broadcast(message);\r\n  }\r\n}\r\n\r\nmodule.exports = SSHHandler;\r\n"],"mappings":"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","ignoreList":[]}